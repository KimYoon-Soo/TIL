# 상속과 조합
- 이직 면접때, 받은 질문이다.<br>
  **"Java의 조합과 상속의 차이에 대해서 설명해주실수 있나요?"**

- 나는 .net 개발자였기에 조합이 뭔지 몰랐고 당연히 **"그 부분은 잘 모르겠습니다."** 라고 답변하였다.<br>
  그리고 <b>"도대체 순열, 조합할때 조합 말고 상속이랑 관련된게 있어?"</b>하면서 찾아보았다.

#### 상속 (Inheritance)
- 장점
1. 코드를 재사용함으로써 중복을 줄일 수 있다.
1. 변화에 대한 유연성 및 확장성이 증가한다.
1. 유지보수가 쉬워지고 개발 시간이 단축된다.

- 단점
1. 캡슐화를 깨뜨린다.<br>
   (* 캡슐화 : 만일의 상황(타인이 외부에서 조작)에 대비해 외부에서 특정 속성이나 메서드를 사용할 수 없도록 숨겨 놓는 것)

#### 조합 (Composition)
- 기존 클래스가 새로운 클래스의 구성 요소로 쓰인다.<br>
  새로운 클래스를 만들고 private 필드로 기존 클래스의 인스턴스를 참조<br>
  즉, 기존 클래스의 메서드를 호출하는 방식으로 동작하게 된다.

#### 상속과 조합 중에 무엇을 사용해야하나?
- **상속보다는 조합을 사용하는 것을 추천**

- 조합은 메서드를 호출하는 방식으로 동작, 그렇기에 캡슐화를 깨뜨리지 않음<br>
  기존 클래스의 변화나 영향이 적어지며, 안전하다.<br>
  메서드 호출 방식이기 때문에 기존 클래스의 인스턴스 변수 타입이 바뀌어도 영향을 받지 않음<br>
  그저 메서드 호출을 통한 값을 사용하면 될뿐이다.

- 아래 예시에서 전화기 클래스에서 usePhone()이 손으로 사용하는 것에서 발로 사용하는 것으로 바뀐다면, 이를 상속받는 스마트폰 클래스도 발로 사용해야함<br>
  하지만 조합은 이런 결함을 숨기는 새로운 API를 설계할 수 있음
``` java
public class 스마트폰 extends 전화기 {
    private int callCount;
    @Override
    public boolean call() {
        callCount++;
        super.call();
    }
    @Override
    public boolean callAll(Collection<? extends E> c) {
        callCount += c.size();
        ...super.callAll();
    }
}
public class 전화기 {
    public boolean call() {
        ...
    }
    public boolean callAll(Collection<? extends E> c) {
        ...call(); // iterate c
    }
    public void usePhone() {
        손으로 사용한다. → 발로 사용해야 한다.
    }
}
```

- 캡슐화를 깨뜨리고, 상위 클래스에 의존하게 되서 변화에 유연하지 못한 상속보다는 조합을 사용하자

#### 상속이 무조건 안좋다면 상속을 굳이 왜 쓰는가?
- 또, 조합이 상속보다 무조건 좋다는 것은 아님

- 상속이 적절하게 사용되면 조합보다 강력하고 개발하기도 편함

- 단, 상속이 적절하게 사용되려면 다음과 같은 조건을 만족해야함
1. 확장을 고려하고 설계가 확실한 IS-A 관계
1. API에 아무런 결함이 없는 경우이거나 결함이 있다면 하위 클래스까지 전파되어도 괜찮은 경우

#### 하지만, 결론적으로 내가 가장 궁금한 점
- 정말 Java 개발자들은 현업에서 조합을 사용하여 대부분 개발을 하는지?!!! 그것이 알고싶다.